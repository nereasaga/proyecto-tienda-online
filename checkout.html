<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHARI - Checkout</title>
    <link rel="stylesheet" href="/styles/mainstyle.css">
    <link rel="stylesheet" href="/styles/checkout.css">
</head>
<body>
    <nav id="navbar">
        <div id="logonav">
            <a href="./index.html"><img src="./img/ghari-logo-h-1.svg" alt="Logo Ghari Relojes"></a>
        </div>
        
         <div id="menunav"> 
            <ul>
                <li><a id="menu-mujer" href="#">Mujer</a></li>
                <li><a id="menu-hombre" href="#">Hombre</a></li>
                <li><a id="menu-unisex" href="#">Unisex</a></li>
                <li><a id="menu-catalogo" href="catalogo.html">Catálogo</a></li>
                <li><a id="menu-contacto" href="#">Contacto</a></li> 
            </ul>
    
        </div>
        <div id="timenav">
            <p id="fecha"></p>
            <p id="hora"></p>
    
        </div>
        <div id="funcionesnav">
            <div id="idiomanav">
                <ul>
                    <li id="espanol"><a href="#">ES</a></li>
                    <li id="english"><a href="#">EN</a></li>
                    <li id="euskara"><a href="#">EUS</a></li>
                </ul>
    
            </div>
            <div id="clientesnav">
                <ul>
                    <li id="icono-cesta"><a href="carrito.html"><img src="./img/bolsa-de-la-compra.png" alt="Cesta"></a></li>
                    <li id="icono-clientes"><a href="cliente.html"><img src="./img/usuario.png" alt="Área clientes"></a></li>
                </ul>
            </div> 
        
          
    <!--nav for tablet version-->
    
       <!-- Hamburger Menu (Checkbox) -->
       <input type="checkbox" id="hamburger-toggle">
       <label for="hamburger-toggle" class="hamburger">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="20" viewBox="0 0 40 20">
          <rect x="0" y="0" width="40" height="4" fill="black" rx="2" />
          <rect x="0" y="12" width="40" height="4" fill="black" rx="2" />
        </svg>
        
       </label>
       
      
    
       <!-- Hamburger Menu Content -->
       <div id="menu-container">
    
       
        
            <div id="menuContent"> 
               <ul>
                   <li><a id="menu-mujer-2" href="#">Mujer</a></li><hr>
                   
                   <li><a id="menu-hombre-2" href="#">Hombre</a></li>
                   <hr>
                   <li><a id="menu-unisex-2" href="#">Unisex</a></li>
                   <hr>
                   <li><a id="menu-catalogo-2" href="catalogo.html">Catálogo</a></li>
                   <hr>
                   <li><a id="menu-contacto-2" href="#">Contacto</a></li> 
                   <hr>
               </ul>
           </div>
    
           <div id="idiomaContent">
               <ul>
                   <li><a id="espanol-2" href="#">ES</a></li>
                   <li><a id="english-2" href="#">EN</a></li>
                   <li><a id="euskara-2" href="#">EUS</a></li>
                   
               </ul>
           </div>
          </div>
        </nav>
<main>
    <div class="div-title">
        <h1>Checkout </h1>
    </div>
    <div class="div-columns">
        <div class="div-form">
            <form action="">
                <div class="div-form-title">
                    <p id="p-envio">DATOS DE ENVÍO</p>
                </div>
                <div class="div-form-input">
                    <input id="ph-nombre" type="text" placeholder="Nombre">
                    <input id="ph-apellidos" type="text" placeholder="Apellidos">
                    <input id="ph-direccion" type="text" placeholder="Dirección">
                    <input id="ph-ciudad" type="text" placeholder="Ciudad">
                    <input id="ph-CP" type="number" placeholder="Código postal">
                    <input id="ph-provincia"  type="text" placeholder="Provincia">
                    <input id="ph-pais"  type="text" placeholder="País">
                    <input id="ph-tfno"  type="text" placeholder="Teléfono">
                    <input id="ph-mail"  type="email" placeholder="Correo electrónico">
                </div>
                <div class="div-form-title">
                    <p id="p-pago">FORMA DE PAGO</p>
                </div>
                <div class="div-form-input">
                    <input id="ph-titular" type="text" placeholder="Titular de la tarjeta">
                    <input id="ph-numTarj" type="text" placeholder="Número de tarjeta">
                    <input id="ph-cad" type="month" placeholder="Fecha de caducidad">
                    <input id="ph-cvc" type="text" placeholder="CVC" pattern="[0-9]+ ">
                </div>
                <div class="div-cart-btn-2">
                    <button type="submit"><span id="span-btn-2">PROCEDER AL PAGO</span></button>
                </div>
            </form>
            </div>
            <div class="div-cart">
                <div class="div-cart-title">
                    <p id="p-resumen-2">RESUMEN DEL PEDIDO</p>
                </div>
                <div class="div-items">
                    
                </div>
                <div class="div-cart-price">
                    <table>
                        <tr>
                            <th id="th-gastos" class="th-mark"><span>Gastos de envío</span></th>
                            <td class="td-monto"><span>0 €</span></td>
                        </tr>
                        <tr>
                            <th class="th-mark">
                                <span id="sp-total" >Total</span>
                            </th>
                            <td class="td-monto"><span>0 €</span></td>
                        </tr>
                    </table>
                </div>
                
        </div>


        </div>

    </div>
</main>
    <!---  FOOTER   --->
    <footer class="footer">
        <!---  LOGO FOOTER   --->
        <div id="div-footer-logo">
          <img src="./img/ghari-logo-v-2.svg" alt="Logo Ghari">
        </div>
        <!---  COLUMNAS FOOTER   --->
        <div id="div-footer-columnas">
          <!--   COLUMNA 1   -->
          <div id="div-footer-columna-1" class="div-footer-columna">
            <h3 id="footer-h3-1" class="titulo-footer">Atención al cliente</h3>
            <ul>
              <li id="footer-ul-1-li-1">Lunes a Viernes de 9 a 18h</li>
              <li id="footer-ul-1-li-2"><a href="#">Whatsapp</a></li>
              <li id="footer-ul-1-li-3"><a href="#">Envíanos un e-mail</a></li>
              <li id="footer-ul-1-li-4"><a href="#">¿Necesitas ayuda?</a></li>
            </ul>
      
          </div>
          <!--   COLUMNA 2   -->
          <div id="div-footer-columna-2" class="div-footer-columna">
            <h3 id="footer-h3-2" class="titulo-footer">Sobre nosotros</h3>
            <ul>
              <li id="footer-ul-2-li-1"><a href="#">Conoce Ghari</a></li>
              <li id="footer-ul-2-li-2"><a href="#">Relojes de alta calidad</a></li>
              <li id="footer-ul-2-li-3"><a href="#">Regalos de empresa</a></li>
            </ul>
      
          </div>
          <!--   COLUMNA 3   -->
          <div id="div-footer-columna-3" class="div-footer-columna">
            <h3 id="footer-h3-3" class="titulo-footer">Información</h3>
            <ul>
              <li id="footer-ul-3-li-1"><a href="#">Condiciones de uso</a></li>
              <li id="footer-ul-3-li-2"><a href="#">Cambios y devoluciones</a></li>
              <li id="footer-ul-3-li-3"><a href="#">Cuida tu reloj</a></li>
              <li id="footer-ul-3-li-4"><a href="#">Pago seguro</a></li>
              <li id="footer-ul-3-li-5"><a href="#">Guía de tallas</a></li>
            </ul>
      
          </div>
        </div>
        <div class="copyright">
            <p id="p-copy">Copyright GHARI RELOJES. Todos los derechos reservados.</p>

        </div>
        </footer>

   <script>
document.addEventListener('DOMContentLoaded', function() {
    // let idiomaActual = 'es-ES'; 
    let producto = localStorage.getItem("producto");
    let productoJSON = JSON.parse(producto);

    let idiomaSeleccionado = localStorage.getItem('idiomaSeleccionado') || 'es'; 
    let idiomaSeleccionado2 = localStorage.getItem('idiomaSeleccionado2') || 'es-ES';

 // CARGAR CATÁLOGOS EN INICIO Y ACTUALIZAR HORA Y FECHA
window.onload = function() {
    iniciarIH();
    cargarCatalogo(idiomaSeleccionado); 
    cambiarIdioma(idiomaSeleccionado);
    let divItems = document.querySelector('.div-items');
    divItems.innerHTML = '<p></p>';
    actualizarResumen();
    console.log(idiomaSeleccionado);
    console.log(idiomaSeleccionado2);

};



    // CARGAR RELOJES
    function cargarCatalogo(idioma) {
        let archivoCatalogo = "json/catalogo-" + idioma + ".json";
        let divItems = document.querySelector('.div-items');
        divItems.innerHTML = '';

        // CARGAR CATALOGO DE IDIOMA SELECCIONADO
        fetch(archivoCatalogo)
            .then(function(response) {
                return response.json();
            })
            .then(function(data) {
                if (productoJSON) {
                    productoJSON.forEach(function(product) {
                        let productoEncontrado = data.find(function(p) {
                            return p.ref === product.ref;
                        });
                        if (productoEncontrado) {
                            anadirCarrito(productoEncontrado, product.cantidad);
                        }
                    });
                }
            });
    }

    //CAMBIAR IDIOMA Y DATOS RELOJES

   function cambiarIdioma(idioma) {
    let archivoIdioma = "json/" + idioma + ".json";
    let archivoCatalogo = "json/catalogo-" + idioma + ".json"; 

    // CAMBIAR IDIOMA DE TEXTOS
    fetch(archivoIdioma)
        .then(function (respuesta) {
            return respuesta.json();
        })

        .then(function(data) {
            for (let key in data) {
                let elemento = document.getElementById(key);
                if (elemento) {
                    if (key.startsWith('ph-')) {
                        elemento.setAttribute('placeholder', data[key]);
                    } else {
                        elemento.textContent = data[key];
                    }
                }
            }
    });
};

    // INYECTAR DIV PRODUCTO A HTML
    function anadirCarrito(producto, cantidad) {
        let divItems = document.querySelector('.div-items');
        let productoHTML = `
            <div class="div-item" data-ref="${producto.ref}">
                <div class="div-image">
                    <img src="${producto['img-1']}" alt="${producto.modelo}">
                </div>
                <div class="div-details">
                    <p class="marcaModelo">${producto.marca} - ${producto.modelo}</p>
                    <p>${producto.tamano} mm, ${producto.material}</p>
                    <p id="precio">${producto.precio} €</p>
                    <span>Cantidad</span><span id="qty">${cantidad}</span>
                    
                </div>
            </div>
        `;
        divItems.innerHTML += productoHTML;
        actualizarResumen();
    }



    // CAMBIAR A INGLÉS
    const btnEn = document.getElementById('english');
    btnEn.addEventListener("click", function() {
        cambiarIdioma("en");
        localStorage.setItem('idiomaSeleccionado', 'en');
        localStorage.setItem('idiomaSeleccionado2', 'en-GB');
        cargarCatalogo("en");
        idiomaSeleccionado = "en",
        idiomaSeleccionado2 = "en-GB";  
        iniciarIH();
    });

    // CAMBIAR A ESPAÑOL
    const btnEs = document.getElementById('espanol');
    btnEs.addEventListener("click", function() {
        cambiarIdioma("es");
        localStorage.setItem('idiomaSeleccionado', 'es');
        localStorage.setItem('idiomaSeleccionado2', 'es-ES');
        idiomaSeleccionado = "es",
        idiomaSeleccionado2 = "es-ES";   
        cargarCatalogo("es");
        iniciarIH();
    });

    // CAMBIAR A EUSKERA
    const btnEus = document.getElementById('euskara');
    btnEus.addEventListener("click", function() {
        cambiarIdioma("eus");
        localStorage.setItem('idiomaSeleccionado', 'eus');
        localStorage.setItem('idiomaSeleccionado2', 'eus');
        idiomaSeleccionado = "eus",
        idiomaSeleccionado2 = "eus";  
        cargarCatalogo("eus");
        iniciarIH();
    });

 // CARGAR HORA Y FECHA 
 function iniciarIH() {let intervaloHora;
 if (intervaloHora) {
   clearInterval(intervaloHora);
 }
 intervaloHora = setInterval(function() {
   F5time(idiomaSeleccionado2);
 }, 1000);
}

    // FUNCIÍN PARA HORA Y FECHA
    function F5time(idioma = 'es-ES') {
        const fechaElemento = document.getElementById("fecha");
        const horaElemento = document.getElementById("hora");
        const ahora = new Date();
        const opcionesFecha = { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' };
        const fechaFormateada = ahora.toLocaleDateString(idioma, opcionesFecha);
        const horaFormateada = ahora.toLocaleTimeString(idioma, { hour: '2-digit', minute: '2-digit', second: '2-digit' });

        fechaElemento.textContent = fechaFormateada.charAt(0).toUpperCase() + fechaFormateada.slice(1);
        horaElemento.textContent = horaFormateada;
    }

});


// TOTAL TABLA
function actualizarResumen() {
    let items = document.querySelectorAll('.div-item'); 
    let total = 0; 

    items.forEach(function(item) {
        let precio = parseFloat(item.querySelector('#precio').textContent.replace('€', '').trim());
        let spCantidad = item.querySelector('#qty');
        let cantidad = parseInt(spCantidad.textContent);

        if (cantidad > 0) {
            total += precio * cantidad; 
        }
    });

    let gastosEnvio = 5.70; 
    let totalGastos = total + gastosEnvio; 

    let filas = document.querySelectorAll('.div-cart-price tr');
    filas[0].querySelector('.td-monto span').textContent = `${gastosEnvio.toFixed(2)} €`; 
    filas[1].querySelector('.td-monto span').textContent = `${totalGastos.toFixed(2)} €`; 
}



   </script>
</body>
</html>
