<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHARI - Mi cesta</title>
    <link rel="stylesheet" href="/styles/mainstyle.css">
    <link rel="stylesheet" href="/styles/carrito.css">
</head>
<body>
    <div id="prenav" class="prenav">
        <div id="date" class="div-date">
            <p>Viernes, 10 de enero de 2025</p>
        </div>
        <div id="time" class="div-time">
          <p>12:00</p>
        </div>
        <div id="idiomas" class="div-idiomas">
            <ul>
                <li>ES</li>
                <li>EN</li>
            </ul>
        </div>
    </div>
    <nav id="navbar">
        <div id="logonav">
            <img src="img/ghari_t.png" alt="Logo Ghari">
        </div>
        <div id="menunav">
            <ul>
                <li id="menu-mujer"><a href="catalogo.html">MUJER</a></li>
                <li id="menu-hombre"><a href="catalogo.html">HOMBRE</a></li>
                <li id="menu-unisex"><a href="catalogo.html">UNISEX</a></li>
                <li id="menu-marcas"><a href="catalogo.html">MARCAS</a></li>
                <li id="menu-catalogo"><a href="catalogo.html">CATÁLOGO</a></li>
            </ul>
        </div>
        <div id="clientes">
            <ul>
                <button id="usuario"><a href="cliente.html"><img src="img/usuario.png" alt="icono clientes"></a></button>
                <button id="carrito"><a href="carrito.html"><img src="img/bolsa-de-la-compra.png" alt="icono carrito"></a></button>
            </ul>
        </div>

    </nav>
<main>
    <div class="div-title">
        <p id="p-guia"><a href="index.html">Inicio </a>/ Mi cesta</p>
        <h1>Mi cesta </h1>
    </div>
    <div class="div-columns">
        <div class="div-items">
            <div class="div-item">
                <img class="btn-cierre" src="img/equis.png" alt="Botón cierre">
                <div class="div-image">
                    <img src="img/ejemplo.avif" alt="">
                </div>
                <div class="div-details">
                    <p class="marcaModelo">MARCA Y MODELO</p>
                    <p>MATERIAL, TAMAÑO</p>
                    <p id="precio">500 €</p>
                    <span>Cantidad</span> <input type="number" min="1">
                </div>

            </div>
            <div class="div-item">
                <img class="btn-cierre" src="img/equis.png" alt="Botón cierre">
                <div class="div-image">
                    <img src="img/ejemplo.avif" alt="">
                </div>
                <div class="div-details">
                    <p class="marcaModelo">MARCA Y MODELO</p>
                    <p>MATERIAL, TAMAÑO</p>
                    <p id="precio">600 €</p>
                    <span>Cantidad</span> <input type="number" min="1">
                </div>

            </div>

        </div>
        <div class="div-cart">
            <div class="div-cart-title">
                <p>RESUMEN DEL PEDIDO</p>
            </div>
            <div class="div-cart-price">
                <table>
                <tr>
                    <th class="th-mark"><span>Total</span></th>
                    <td class="td-monto"><span>$$$</span></td>
                </tr>
                <tr>
                    <th class="th-mark"><span>IVA 21%</span></th>
                    <td class="td-monto"><span>$$$</span></td>
                </tr>
                <tr>
                    <th class="th-mark"><span>Gastos de envío</span></th>
                    <td class="td-monto"><span>$$$</span></td>
                </tr>
                <tr>
                    <th class="th-mark"><span>Total</span></th>
                    <td class="td-monto"><span>$$$</span></td>
                </tr>
            </table>

            </div>
            <div class="div-cart-btn">
                <button type="submit"><span id="span-btn">COMPRAR</span></button>
            </div>

        </div>

    </div>
</main>
    <!---  FOOTER   --->
<footer class="footer">
    <!---  LOGO FOOTER   --->
    <div id="div-footer-logo">
        <img src="img/ghari_t.png" alt="Logo Ghari">
    </div>
    <!---  COLUMNAS FOOTER   --->
    <div id="div-footer-columnas">
      <div id="div-footer-columna-1" class="div-footer-columna">
        <h3 id="footer-h3-1">Atención al cliente</h3>
        <ul>
          <li id="footer-columna-1-li-1">Lunes a Viernes de 9 a 18h</li>
          <li id="footer-columna-1-li-2"><a href="#">Whatsapp</a></li>
          <li id="footer-columna-1-li-3"><a href="#">Envíanos un e-mail</a></li>
          <li id="footer-columna-1-li-4"><a href="#">¿Necesitas ayuda?</a></li>
        </ul>
  
      </div>
      <div id="div-footer-columna-2" class="div-footer-columna">
        <h3 id="footer-h3-2">Sobre nosotros</h3>
        <ul>
          <li id="footer-columna-2-li-1"><a href="#">Conoce Ghari</a></li>
          <li id="footer-columna-2-li-2"><a href="#">Relojes de alta calidad</a></li>
          <li id="footer-columna-2-li-3"><a href="#">Regalos de empresa</a></li>
        </ul>
  
      </div>
      <div id="div-footer-columna-3" class="div-footer-columna">
        <h3 id="footer-h3-3">Información</h3>
        <ul>
          <li id="footer-columna-3-li-1"><a href="#">Condiciones de uso</a></li>
          <li id="footer-columna-3-li-2"><a href="#">Cambios y devoluciones</a></li>
          <li id="footer-columna-3-li-3"><a href="#">Cuida tu reloj</a></li>
          <li id="footer-columna-3-li-4"><a href="#">Pago seguro</a></li>
          <li id="footer-columna-3-li-5"><a href="#">Guía de tallas</a></li>
        </ul>
  
      </div>
    </div>
          <!-- <p id="pCopy">Copyright (c) 2025. Todos los derechos reservados.</p> -->
      </footer>

   <script>
    // BORRADO DE DIV-ITEM
    document.querySelector(".div-items").addEventListener("click", function(borrarItem) {
            if (event.target.closest(".btn-cierre")) {
                const divItem = event.target.closest(".div-item");
                divItem.remove();
                actualizarResumen();
            }
        });

        
    //CARGAR DATOS DE RELOJES

        fetch('json/catalogo-es.json')
            .then(function(response) {
                return response.json(); 
            })
            .then(function(data) {
                let productoEncontrado = data.find(function(producto) {
                    return producto.ref === "R0003";  
                });

                if (productoEncontrado) {
            const divItems = document.querySelector('.div-items');

            let productoHTML = `
                <div class="div-item">
                    <img class="btn-cierre" src="img/equis.png" alt="Botón cierre">
                    <div class="div-image">
                        <img src="${productoEncontrado['img-1']}" alt="${productoEncontrado.modelo}">
                    </div>
                    <div class="div-details">
                        <p class="marcaModelo">${productoEncontrado.marca} - ${productoEncontrado.modelo}</p>
                        <p>${productoEncontrado.tamano} mm, ${productoEncontrado.material}</p>
                        <p id="precio">${productoEncontrado.precio} €</p>
                        <span>Cantidad</span> <input type="number" min="1" max="${productoEncontrado.stock}">
                    </div>
                </div>
            `;

            divItems.innerHTML = productoHTML;

        } else {
            let divItems = document.querySelector('.div-items');
            divItems.innerHTML = '<p>Producto no encontrado.</p>';
        }
    });

// TOTAL TABLA
function actualizarResumen() {
    let items = document.querySelectorAll('.div-item');
    let total = 0;

    items.forEach(function(item) {
    let precio = parseFloat(item.querySelector('#precio').textContent.replace('€', '').trim());
    let cantidadInput = item.querySelector('.div-details input[type="number"]');
    let cantidad = parseInt(cantidadInput.value);


    total += precio * cantidad;
    })


    let iva = total * 0.21; 
    let gastosEnvio = 5.70; 
    let totalGastos = total + gastosEnvio;

    let filas = document.querySelectorAll('.div-cart-price tr');

    filas[0].querySelector('.td-monto span').textContent = `€ ${total.toFixed(2)}`;
    filas[1].querySelector('.td-monto span').textContent = `€ ${iva.toFixed(2)}`;       
    filas[2].querySelector('.td-monto span').textContent = `€ ${gastosEnvio.toFixed(2)}`; 
    filas[3].querySelector('.td-monto span').textContent = `€ ${totalGastos.toFixed(2)}`; 
}

document.querySelector('.div-items').addEventListener('input', function(event) {
    if (event.target.type === 'number') {
        actualizarResumen();
    }
});

// CALCULAR TABLA
document.addEventListener('DOMContentLoaded', actualizarResumen);
   </script>
</body>
</html>
